version: '3'

services:
  node-1:
    image: megachips/ring-election:latest
    environment:
      NODE_ENV: dev
      PORT: 3000
      MONITORING_PORT: 9000
      NUM_PARTITIONS: 128
      SEED_NODES: 172.40.0.11:3000,172.40.0.12:3000,172.40.0.13:3000,172.40.0.14:3000,172.40.0.15:3000
    hostname: node-1
    ports:
      - 9001:9000
      - 8001:6379
      - 7001:26379
    networks:
      ring:
        ipv4_address: 172.40.0.11
  node-2:
    image: megachips/ring-election:latest
    environment:
      NODE_ENV: dev
      PORT: 3000
      MONITORING_PORT: 9000
      NUM_PARTITIONS: 128
      SEED_NODES: 172.40.0.11:3000,172.40.0.12:3000,172.40.0.13:3000,172.40.0.14:3000,172.40.0.15:3000
    hostname: node-2
    ports:
      - 9002:9000
      - 8002:6379
      - 7002:26379
    networks:
      ring:
        ipv4_address: 172.40.0.12
  node-3:
    image: megachips/ring-election:latest
    environment:
      NODE_ENV: dev
      PORT: 3000
      MONITORING_PORT: 9000
      NUM_PARTITIONS: 128
      SEED_NODES: 172.40.0.11:3000,172.40.0.12:3000,172.40.0.13:3000,172.40.0.14:3000,172.40.0.15:3000
    hostname: node-3
    ports:
      - 9003:9000
      - 8003:6379
      - 7003:26379
    networks:
      ring:
        ipv4_address: 172.40.0.13
  node-4:
    image: megachips/ring-election:latest
    environment:
      NODE_ENV: dev
      PORT: 3000
      MONITORING_PORT: 9000
      NUM_PARTITIONS: 128
      SEED_NODES: 172.40.0.11:3000,172.40.0.12:3000,172.40.0.13:3000,172.40.0.14:3000,172.40.0.15:3000
    hostname: node-4
    ports:
      - 9004:9000
      - 8004:6379
      - 7004:26379
    networks:
      ring:
        ipv4_address: 172.40.0.14
  node-5:
    image: megachips/ring-election:latest
    environment:
      NODE_ENV: dev
      PORT: 3000
      MONITORING_PORT: 9000
      NUM_PARTITIONS: 128
      SEED_NODES: 172.40.0.11:3000,172.40.0.12:3000,172.40.0.13:3000,172.40.0.14:3000,172.40.0.15:3000
    hostname: node-5
    ports:
      - 9005:9000
      - 8005:6379
      - 7005:26379
    networks:
      ring:
        ipv4_address: 172.40.0.15
networks:
  ring:
    ipam:
      config:
        - subnet: 172.40.0.0/16
